<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login - AgroLife</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
body {
    background: url('media/img1.webp');
    background-size: cover;
    background-position: center;
    height: 100vh;
}

.overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.6);
}

.login-container {
    position: relative;
    z-index: 2;
    height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
}

.login-box {
    background: white;
    padding: 30px;
    border-radius: 10px;
    width: 380px;
    text-align: center;
}

input {
    width: 100%;
    margin: 8px 0;
    padding: 8px;
}

.error {
    color: red;
    font-size: 13px;
    display: none;
}

.toggle-text {
    font-size: 14px;
    cursor: pointer;
}
</style>

<script>

function clearFields() {
    document.getElementById("username").value = "";
    document.getElementById("email").value = "";
    document.getElementById("password").value = "";
    document.getElementById("errorMsg").style.display = "none";
}

function showSignup() {
    clearFields(); // Clear inputs when switching

    document.getElementById("loginTitle").innerText = "AgroLife Sign Up";
    document.getElementById("authBtn").innerText = "Sign Up";
    document.getElementById("usernameField").style.display = "block"; // show username

    document.getElementById("toggleText").innerHTML =
      'Already have an account? <span class="text-success" onclick="showLogin()">Login</span>';
}

function showLogin() {
    clearFields(); // Clear inputs when switching

    document.getElementById("loginTitle").innerText = "AgroLife Login";
    document.getElementById("authBtn").innerText = "Login";
    document.getElementById("usernameField").style.display = "none"; // hide username

    document.getElementById("toggleText").innerHTML =
      'Don’t have an account? <span class="text-success" onclick="showSignup()">Sign Up</span>';
}

function isValidEmail(email) {
    const pattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return pattern.test(email);
}

function validateFields(mode) {
    let username = document.getElementById("username").value.trim();
    let email = document.getElementById("email").value.trim();
    let password = document.getElementById("password").value.trim();
    let error = document.getElementById("errorMsg");

    if (mode === "signup" && username === "") {
        error.style.display = "block";
        error.innerText = "⚠️ Please enter a username!";
        return false;
    }

    if (email === "" || password === "") {
        error.style.display = "block";
        error.innerText = "⚠️ Please fill all required fields!";
        return false;
    }

    if (!isValidEmail(email)) {
        error.style.display = "block";
        error.innerText = "⚠️ Please enter a valid email address!";
        return false;
    }

    if (password.length < 6) {
        error.style.display = "block";
        error.innerText = "⚠️ Password must be at least 6 characters!";
        return false;
    }

    error.style.display = "none";
    return true;
}


window.onload = function() {
    const btn = document.getElementById("authBtn");

    btn.addEventListener("click", function() {
        const mode = btn.innerText === "Sign Up" ? "signup" : "login";

        if (mode === "signup") {
            if (!validateFields("signup")) return;
            alert("✅ Signup Successful! Now login to continue.");
            clearFields();
            showLogin();
        } else {
            if (!validateFields("login")) return;
            alert("✅ Login Successful!");
            clearFields();
            window.location.href = "about.html";
        }
    });
};
</script>

</head>

<body>

<div class="overlay"></div>

<div class="login-container">
  <div class="login-box shadow-lg">
    <h3 class="text-success" id="loginTitle">AgroLife Login</h3>

    <div id="errorMsg" class="error mb-2"></div>

    <!-- Username field (ONLY for SIGNUP) -->
    <div id="usernameField" style="display:none;">
      <input type="text" id="username" placeholder="Username">
    </div>

    <input type="email" id="email" placeholder="Email">
    <input type="password" id="password" placeholder="Password">

    <button class="btn btn-success w-100" id="authBtn">
      Login
    </button>

    <hr>

    <p id="toggleText" class="toggle-text">
      Don’t have an account?
      <span class="text-success" onclick="showSignup()">Sign Up</span>
    </p>

    <a href="index.html" class="text-decoration-none">← Back to Home</a>
  </div>
</div>

</body>
</html>
